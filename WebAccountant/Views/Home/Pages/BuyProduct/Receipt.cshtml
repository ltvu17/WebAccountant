@model WebAccountant.ModelsBase.Ktsc
@{
    Html.RenderPartial("../Home/Header");
}
<div class="text-center">
    <div class="home-container">
        @Html.Partial("../Home/SideBar")
        <div class="right-bar-home content">
            <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" style="border-radius:0px !important">
                <div class="modal-dialog  modal-xl">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" style="color: #119583;" id="exampleModalLabel">Thêm Bằng Phiếu Thu</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Đóng"></button>
                        </div>
                        <div class="modal-body">
                            <form id="add-thu" method="post" asp-controller="Ktscs" asp-action="AddPhieuThuTien">
                                <div class="row">
                                    <div class="col-3">
                                        <div class="mb-3 text-start">
                                            <label for="makh" class="col-form-label">Mã khách hàng:</label>
                                            <input type="text"
                                                   class="form-control"
                                                   asp-for="Makh"
                                                   placeholder="Nhập mã khách hàng..."
                                                   id="makh"
                                                   onkeyup="SearchNow('list-makh-sugg','makh','list-makh-sugg')" />
                                            <span id="valid-makh" class="text-danger"></span>
                                            <div class="table-container">
                                                <table id="list-makh-sugg" class="sugg-container d-none">
                                                    <tr id="tr-1">
                                                        <td class="width-120">Mã khách hàng</td>
                                                        <td class="width-250">Tên khách hàng</td>
                                                        <td class="width-120">Mã số doanh nghiệp</td>
                                                    </tr>
                                                </table>
                                            </div>
                                        </div>

                                        <div class="mb-3 text-start">
                                            <label for="dt" class="col-form-label">Điện thoại :</label>
                                            <input type="text" class="form-control" id="dt" readonly>
                                            <span id="valid-dt" class="text-danger"></span>
                                        </div>
                                        <div class="mb-3 text-start">
                                            <label for="manv" class="col-form-label">Mã nhân viên :</label>
                                            <input type="text"
                                                   class="form-control"
                                                   id="manv"
                                                   placeholder="Nhập mã nhân viên..."
                                                   onkeyup="SearchNow('list-manv-sugg','manv','list-manv-sugg')" />
                                            <span id="valid-manv" class="text-danger"></span>
                                            <div class="table-container">
                                                <table id="list-manv-sugg" class="sugg-container d-none">
                                                    <tr id="tr-1">
                                                        <td class="width-120">Mã nhân viên</td>
                                                        <td class="width-250">Tên nhân viên</td>
                                                        <td class="width-120">Tên phòng ban</td>
                                                    </tr>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="mb-3 text-start">
                                            <label for="tenkh" class="col-form-label">Tên khách hàng:</label>
                                            <input type="text" class="form-control" id="tenkh" asp-for="Tenkh" readonly>
                                        </div>
                                        <div class="mb-3 text-start">
                                            <label for="diachi" class="col-form-label">Địa chỉ:</label>
                                            <input type="text" class="form-control" id="diachi" asp-for="Diachi" readonly>
                                        </div>
                                        <div class="mb-3 text-start">
                                            <label for="tennv" class="col-form-label">Mã số doanh nghiệp:</label>
                                            <input type="text" class="form-control" id="msdn" asp-for="MsDn" readonly>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="mb-3 text-start">
                                            <label for="ht" class="col-form-label">Ngày hóa đơn</label>
                                            <input type="datetime-local" class="form-control" asp-for="NgayHd" id="ht" value="@DateTime.UtcNow.AddHours(7).ToString("s")">
                                            <input type="datetime-local" class="form-control" asp-for="Ngayct" id="ht" value="@DateTime.UtcNow.AddHours(7).ToString("s")" hidden>
                                        </div>
                                        <div class="mb-3 text-start">
                                            <label for="sohd" class="col-form-label">Số hóa đơn:</label>
                                            <input type="text" class="form-control" id="sohd" readonly>
                                        </div>
                                        <div class="mb-3 text-start">
                                            <label for="sohd" class="col-form-label">Tổng tiền thu:</label>
                                            <input type="text" class="form-control" id="t-tongtien" onchange="formatNumber()">
                                            <input type="number" asp-for="Ttvnd" class="form-control" id="tongtien" hidden>
                                            <span id="valid-tongtien" class="text-danger"></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
                                    <button type="button" class="btn btn-primary" onclick="submitModal()">Thêm</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <div id="collect-data">
                @(
                    Html.DevExtreme().DataGrid<WebAccountant.ModelsBase.Ktsc>()
                    .ID("gridContainer")
                    .DataSource(ds => ds.Mvc()
                    .Controller("Ktscs")
                    .LoadAction("GetPhieuNhapKho")
                    .Key("SttSc")
                    )
                    .RemoteOperations(true)
                    .FocusedRowEnabled(true)
                    .Columns(columns =>
                    {
                        columns.AddFor(m => m.Lctg).Caption("Chứng từ").Fixed(true);

                        columns.AddFor(m => m.SoHd).Caption("Số hóa đơn").Fixed(true);

                        columns.AddFor(m => m.NgayHd).Caption("Ngày hóa đơn").Fixed(true);

                        columns.AddFor(m => m.SrHd).Caption("Seri hóa đơn");

                        columns.AddFor(m => m.Soct).Caption("Số chứng từ");

                        columns.AddFor(m => m.Ngayct).Caption("Ngày chứng từ").DataType(GridColumnDataType.Date).Fixed(true).Format("dd/MM/yyyy");

                        columns.AddFor(m => m.Diengiai).Caption("Diễn giải");

                        columns.AddFor(m => m.Tkno).Caption("Tài khoản nợ");

                        columns.AddFor(m => m.Madtpnno).Caption("Mã đối tượng pháp nhân nợ");

                        columns.AddFor(m => m.Tkco).Caption("Tài khoản có");

                        columns.AddFor(m => m.Madmco).Caption("Mã danh mục có");

                        columns.AddFor(m => m.Tendm).Caption("Tên danh mục");

                        columns.AddFor(m => m.Donvi).Caption("Đơn vị");

                        columns.AddFor(m => m.Luong).Caption("Số lượng").Format("0,###");

                        columns.AddFor(m => m.Ttvnd).Caption("Thành tiền VND").Format("0,###");

                        columns.AddFor(m => m.PtCk).Caption("% CK");

                        columns.AddFor(m => m.PtCk2).Caption("% CK2");

                        columns.AddFor(m => m.Chietkhau).Caption("Chiết khấu 1").Format("0,###");

                        columns.AddFor(m => m.Chietkhau2).Caption("Chiết khấu 2").Format("0,###");

                        columns.AddFor(m => m.Tkthue).Caption("TK Thuế");

                        columns.AddFor(m => m.TsGtgt).Caption("% TS");

                        columns.AddFor(m => m.Thuevnd).Caption("Thuế VND").Format("0,###");

                        columns.AddFor(m => m.Makh).Caption("Mã khách hàng");

                        columns.AddFor(m => m.Tenkh).Caption("Tên khách hàng").Width(300);

                        columns.AddFor(m => m.Diachi).Caption("Địa chỉ").Width(400);
                        
                        columns.AddFor(m => m.DiachiNgd).Caption("Địa chỉ").Width(400);

                        columns.AddFor(m => m.NvBan).Caption("Người giao dịch");

                        columns.AddFor(m => m.MsDn).Caption("Mã số doanh nghiệp"); 
                    }
                    )
                    .ShowColumnHeaders(true)
                    .ColumnAutoWidth(true).AllowColumnResizing(true).ColumnResizingMode(ColumnResizingMode.Widget).FilterRow(ft => ft.Visible(true))
                    .RowAlternationEnabled(true).WordWrapEnabled(true)
                    .ShowBorders(true).Paging(paging => paging.PageSize(10))
                    .Height(800)
                    .AllowColumnResizing(true)
                    .Pager(pager =>
                    {
                        pager.Visible(true);
                        pager.DisplayMode(GridPagerDisplayMode.Compact);
                        pager.ShowPageSizeSelector(true);
                        pager.AllowedPageSizes(new JS("[10, 15, 25, 40]"));
                        pager.ShowInfo(true);
                        pager.ShowNavigationButtons(true);
                    })
                    .Summary(s => s
                    .RecalculateWhileEditing(true)
                    .TotalItems(items =>
                    {
                        items.AddFor(m => m.Ttvnd)
                        .SummaryType(SummaryType.Sum)
                        .DisplayFormat("{0}")
                        .ValueFormat("0,###");

                        items.AddFor(m => m.Luong)
                        .SummaryType(SummaryType.Sum)
                        .DisplayFormat("{0}")
                        .ValueFormat("0,###");
                    })
                    ))
                @* <div class="footer-data d-flex justify-content-start">
                    <button class="btn btn-primary width-100" data-bs-toggle="modal" id="btnAdd" data-bs-target="#exampleModal">Thêm</button>
                </div> *@
            </div>
        </div>
    </div>
</div>
